# Security configurations

# Block common exploit attempts
location ~ \.(php|php3|php4|php5|phtml|phps)$ {
    deny all;
    return 403;
}

# Block access to hidden files
location ~ /\. {
    deny all;
    return 403;
}

# Block access to backup files
location ~ ~$ {
    deny all;
    return 403;
}

# Block access to version control directories
location ~ /\.(git|svn|hg|bzr) {
    deny all;
    return 403;
}

# Block common exploit paths
location ~* /(vendor|phpunit|eval-stdin|containers/json|think/app) {
    deny all;
    return 403;
}

# Rate limiting
limit_req_zone $binary_remote_addr zone=general:10m rate=10r/s;
limit_req_zone $binary_remote_addr zone=api:10m rate=30r/s;
limit_conn_zone $binary_remote_addr zone=addr:10m;